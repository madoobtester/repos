<!doctype html><html lang="en">
<head><meta charset="UTF-8">
<meta name=viewport content="width=device-width, initial-scale=1">
<link rel="STYLESHEET" href="../main.css" type="text/css">
<title>New-CIMSessionOption - PowerShell - SS64.com</title>
</head><body><!-- #BeginLibraryItem "/Library/head_ps.lbi" --><div id="tnav"><ul>
<li class="tbtn"><a href="../"> ( &nbsp;SS64 &nbsp;)</a></li>
<li class="tbtn"><a href="../ps">PowerShell</a></li>
<li class="tbtn"><a href="syntax.html">Syntax</a></li>
<li><div id="search"><form action="https://www.google.com/search" method="get">
<input type="text" name="q" id="q" size="27" maxlength="255">
<input class="submit" value="Search" id="btn" type="submit">
<input type="hidden" name="sitesearch" value="ss64.com/ps/"></form></div></li>
</ul></div><!-- #EndLibraryItem -->
<h1>New-CIMSessionOption</h1> 
<p>Specifies advanced options for <a href="new-cimsession.html">New-CimSession</a>. <br>
New-CIMSessionOption is available in PowerShell 3.0+</p>
<pre>Syntax
      New-CimSessionOption [-Protocol] {Dcom | Default | Wsman}
         [-Culture <i>CultureInfo</i>] [-UICulture <i>CultureInfo</i>] [<i>CommonParameters</i>]
    
      New-CimSessionOption [-Culture <i>CultureInfo</i>] [-EncodePortInServicePrincipalName] [-Encoding <i>PacketEncoding</i>] 
         [-HttpPrefix <i>Uri</i>] [-MaxEnvelopeSizeKB <i>UInt32</i>] [-NoEncryption] [-ProxyAuthentication <i>PasswordAuthenticationMechanism</i>]
            [-ProxyCertificateThumbprint <i>String</i>] [-ProxyCredential <i>PSCredential</i>] 
               [-ProxyType <i>ProxyType</i>] [-SkipCACheck] [-SkipCNCheck] [-SkipRevocationCheck] [-UICulture <i>CultureInfo</i>]
                  [-UseSsl] [<i>CommonParameters</i>]
    
      New-CimSessionOption [-Culture <i>CultureInfo</i>] [-Impersonation <i>ImpersonationType</i>] [-PacketIntegrity] 
         [-PacketPrivacy] [-UICulture <i>CultureInfo</i>] [<i>CommonParameters</i>]

Key
   -Culture <i>CultureInfo</i>
       Specifies the user interface culture to use for the CIM session. Specify the value for this parameter using 
       one of the following formats:

         Enter a culture name in <i>languagecode2</i>-<i>country/regioncode2</i> format such as "EN-US". 
         A variable that contains a CultureInfo object. 
         A command that gets a CultureInfo object, such as <a href="get-culture.html">Get-Culture</a>.

   -EncodePortInServicePrincipalName
       Indicates that the Kerberos connection is connecting to a service whose service principal name (SPN) includes 
       the service port number. This type of connection is not common.

   -Encoding <i>PacketEncoding</i>
       The encoding used for the WsMan protocol:  psdx_paramvalues Default, Utf8, or Utf16.

   -HttpPrefix <i>Uri</i>
       The part of the HTTP URL after the computer name and port number. Changing this is not common.
       By default, the value of this parameter is /wsman.

   -Impersonation <i>ImpersonationType</i>
       Creates a DCOM session to Windows Management Instrumentation (WMI) using impersonation.

       Valid values for this parameter are: 

        -- Default: DCOM can choose the impersonation level using its normal security negotiation algorithm. 
        -- None: The client is anonymous to the server. The server process can impersonate the client, but the 
                 impersonation token does not contain any information and cannot be used. 

        -- Identify: Allows objects to query the credentials of the caller. 
        -- Impersonate: Allows objects to use the credentials of the caller. 
        -- Delegate: Allows objects to permit other objects to use the credentials of the caller.

        If Impersonation is not specified, the New-CimSession cmdlet uses the value of 3: Impersonate

   -MaxEnvelopeSizeKB <i>UInt32</i>
       The size limit of WsMan XML messages for either direction.

   -NoEncryption
       Turn off data encryption.

   -PacketIntegrity
       Use the Component Object Model (COM) PacketIntegrity functionality for the DCOM session created to WMI.
       By default all CIM sessions created using DCOM have -PacketIntegrity set to True.

   -PacketPrivacy
       Create a DCOM session to WMI using the COM PacketPrivacy.
       By default all CIM sessions created using DCOM have -PacketPrivacy set to True.

   -Protocol <i>ProtocolType</i>
       The protocol to use:    psdx_paramvaluesDCOM or WinRM.

   -ProxyAuthentication <i>PasswordAuthenticationMechanism</i>
       The authentication method to use for proxy resolution.
          psdx_paramvaluesDefault, Digest, Negotiate, Basic, Kerberos, NtlmDomain, or CredSsp.

   -ProxyCertificateThumbprint <i>String</i>
       The (x.509) digital public key certificate of a user account for proxy authentication. Enter the 
       certificate thumbprint of the certificate.

       Certificates are used in client certificate-based authentication. They can only be mapped to local user 
       accounts and they do not work with domain accounts.

       To get a certificate thumbprint, use the <a href="get-item.html">Get-Item</a> or <a href="get-childitem.html">Get-ChildItem</a> cmdlets in the wps_2 Cert: drive.

   -ProxyCredential <i>PSCredential</i>
       The credentials to use for proxy authentication. Enter one of the following: 

        -- A variable that contains a PSCredential object. 
        -- A command that gets a PSCredential object, such as Get-Credential

       If this option is not set, then you cannot specify any credentials.

   -ProxyType <i>ProxyType</i>
       The host name resolution mechanism to use.

        psdx_paramvaluesNone, WinHttp, Auto, or InternetExplorer.

       By default, the value of this parameter is InternetExplorer.

   -SkipCACheck
       Indicates that when connecting over HTTPS, the client does not validate that the server certificate is signed 
       by a trusted certification authority (CA).

       Use this parameter only when the remote computer is trusted using another mechanism, such as when the remote 
       computer is part of a network that is physically secure and isolated, or when the remote computer is listed as 
       a trusted host in a WinRM configuration.

   -SkipCNCheck
       Indicates that the certificate common name (CN) of the server does not need to match the hostname of the 
       server.

       Use this parameter only for remote operations that use the HTTPS protocol.
       Note: use this parameter only for trusted computers.

   -SkipRevocationCheck
       Indicates that the revocation check for server certificates is skipped.
       Note: use this parameter only for trusted computers.

   -UICulture <i>CultureInfo</i>
       Specifies the user interface culture to use for the CIM session. Specify the value for this parameter using 
       one of the following formats:

         - Enter a culture name in <i>languagecode2</i>-<i>country/regioncode2</i> format such as "EN-US". 
   
         - A variable that contains a CultureInfo object. 

         - A command that gets a CultureInfo object, such as <a href="get-culture.html">Get-Culture</a>.

   -UseSsl
       Indicates that SSL should be used to establish a connection to the remote computer. By default, SSL is not used.

       WsMan encrypts all content that is transmitted over the network. This parameter lets you specify the 
       additional protection of HTTPS instead of HTTP. If SSL is not available on the port used for the connection 
       and you specify this parameter, then the command fails.

       It is recommended that you use this parameter only when the PacketPrivacy parameter is not specified.

   <a href="common.html">CommonParameters</a>:
       -Verbose, -Debug, -ErrorAction, -ErrorVariable, -WarningAction, -WarningVariable,
       -OutBuffer, -PipelineVariable -OutVariable.</pre>
<p>Standard <a href="get-alias.html">Aliases</a> for New-CIMSessionOption:<span class="code"> <b>ncso</b></span></p>
<p>The New-CimSessionOption cmdlet creates an instance of a CIM session options object. You use a CIM session options object as input to the New-CimSession cmdlet to specify the options for a CIM session.</p>
<p>This cmdlet has two parameter sets, one for WsMan options and one for Distributed Component Object Model (DCOM) options. Depending on which parameters you use, the cmdlet returns either an instance of DCOM session options or returns WsMan session options.</p>
<p><b>Examples</b></p>
<p>Create a CIM session options object for DCOM and then create a new CIM session to Server64:</p>
<p class="code">PS C:\&gt; $so = New-CimSessionOption -Protocol DCOM<br>
PS C:\&gt; New-CimSession -ComputerName Server64 -SessionOption $so</p>
<p>Create a CIM session options object for WsMan, set the authentication mode to Kerberos and credentials via the $cred variable:<b><span class="code"></span></b></p>
<p class="code">PS C:\&gt; New-CimSessionOption -ProxyAuthentication Kerberos -ProxyCredential $cred -SkipCACheck -SkipCNCheck -UseSsl</p>
<p><i class="quote">“Nothing that you do will ever feel good if you let people convince you that you have no choice” ~ Fiona Apple</i></p>
<p><b>Related PowerShell Commands:</b></p>
<p><a href="new-cimsession.html">New-CIMSession</a> -  Create a CIM session.<br>
<a href="get-ciminstance.html">Get-CIMInstance</a> -  Get a managed resource (storage, network, software etc)<br>
</p><!-- #BeginLibraryItem "/Library/foot_ps.lbi" --><p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- PowerShell300 -->
<ins class="adsbygoogle"
     style="display:inline-block;width:300px;height:250px"
     data-ad-client="ca-pub-6140977852749469"
     data-ad-slot="6253539900"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
<hr>
<div id=bl class="footer">&nbsp;</div>
<div id=br class="footer, tagline">Copyright &copy; <a href="https://ss64.com/">SS64.com</a> 1999-2019<br>
Some rights reserved</div><!-- #EndLibraryItem --></body>
</html>
